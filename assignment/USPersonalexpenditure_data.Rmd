---
output: pdf_document
---
#R 데이터를 이용하여 시각화해보기

---------------------------------------

###목적 : R에 내장된 데이터를 활용하여 데이터를 가공하여 시각화한 자료를 R마크다운을 이용하여 문서로 작성해보자

---------------------------------------

먼저 `data()`를 사용하여 R에 내장되어있는 데이터를 확인해보았다.
그중에 USPersonalexpenditure라는 데이터셋을 통해 `시간`, `성별`, `나이`에 따른 경비를 분석할 수 있지 않을까 하는 생각을 하였다.

하지만...

```{r}
 data("USPersonalExpenditure")
 head(USPersonalExpenditure)
```
나의 예상과는 달리 데이터셋은 `연도별` 지출데이터였다. 
또한, 데이터의 형태는 데이터프레임 형태가 아닌 **vector** `num[1:5][1:5]`형태의 데이터로 구성되어 있었다. 

따라서 해당 데이터를 분석하기 위해 벡터형태의 데이터를 데이터 프레임 형태로 만들었다.

```{r}
upe = data.frame(USPersonalExpenditure)
head(upe)
```
아직 부족한 점이 몇가지 보인다.

1. X축으로 사용될 연도가 'X1940'과 같이 연도 앞에 X값이 붙음
2. 각 case를 묶는 칼럼값이 존재하지 않음

따라서, 이 문제를 수정하기 위해 `colnames()`와 `rownames()`를 적절히 활용하여 데이터를 수정하기로 했다

```{r}
colnames(upe) = c(1940, 1945, 1950, 1955, 1960)
upe$case = rownames(upe)
rownames(upe) = NULL
head(upe)
```

마지막으로 현재 데이터셋이 `wide`형태이기 때문에 시각화하기 어려우므로 `long`형태로 만들고자 **shape** 라이브러리를 사용하여
데이터를 변형시키기로 했다

```{r}
library(reshape2)
long_upe = melt(USPersonalExpenditure, id.vars = case)
```

끝으로 해당 데이터를 바탕으로 라인그래프를 통해 시각화 해보았다.

```{r}
library(ggplot2)
ggplot(long_upe, aes(Var2, value, group = Var1, color = Var1)) +
  geom_line()
```

*Food and Tabacco*값이 시간이 갈수록 치솟는 것을 알 수 있는데, 아쉬운점은 증가에 기여한 값이 음식인지, 담배인지, 둘다인지 알기 어렵다는 것이다.
1945년에 세계대전을 거치면서 미국이 급성장할때 가장먼저 증가한 것이 음식과 담배이고 가정부 관련 운영이 늘었다는 것이 아이러니하다.
성장이 급격할수록 빈부격차가 심해지면서 생기는 문제같은데, `빈부격차에 대한 데이터셋`도 추가로 볼 수 있으면 좋을 것 같다.

의료, 의학기술이 발달하면서 점차 의료비 지출이 증가하는 것을 볼 수 있는데, 이를 국가별로 보면 더 의미가 있을 것 같다. 우리나라의 경우 의료보험이 
전 국민적으로 잘 되어있는 편이라 지출이 낮을 것으로 생각된다.

교육비지출의 경우 대중교육이 잘되어있어 지출비용이 적은건지, 애초에 교육을 받지 못하는 것인지 추가적인 자료가 있으면 좋을 것 같다.
진학률이나, 졸업률 자료, 교육비에 대한 투자비용등이 추가로 모여지면 미국의 교육수준을 가늠할 수 있는 정보가 되지 않을까 생각된다.








